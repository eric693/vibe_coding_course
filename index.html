<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe Studio - å‰µé€ ä½ çš„æ•¸ä½ä½œå“</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #e94560;
            --accent-light: #ff6b88;
            --text: #f4f4f4;
            --text-dim: #a0a0a0;
            --bg: #0f0f1e;
            --card: #1a1a2e;
            --border: rgba(233, 69, 96, 0.2);
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        .font-display {
            font-family: 'Playfair Display', serif;
        }

        .grain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.03;
            z-index: 1000;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        .glow {
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.3), 0 0 40px rgba(233, 69, 96, 0.1);
        }

        .spotlight {
            position: fixed;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle at var(--x, 50%) var(--y, 50%), rgba(233, 69, 96, 0.15) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
            transition: opacity 0.3s ease;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        .animate-float {
            animation: float 6s ease-in-out infinite;
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }

        .loading-shimmer {
            background: linear-gradient(90deg, transparent, rgba(233, 69, 96, 0.1), transparent);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: var(--secondary);
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 3px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--accent-light);
        }

        textarea {
            resize: none;
        }

        .preview-frame {
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: hidden;
            background: white;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .code-block {
            background: var(--secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #a0a0a0;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 400px;
            overflow-y: auto;
        }

        .template-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(233, 69, 96, 0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(233, 69, 96, 0.4);
        }

        .btn-secondary {
            border: 1px solid var(--border);
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--secondary);
            border-color: var(--accent);
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: var(--accent) !important;
            box-shadow: 0 0 0 3px rgba(233, 69, 96, 0.1);
        }

        .modal-backdrop {
            backdrop-filter: blur(10px);
            background: rgba(15, 15, 30, 0.8);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .spinner {
            animation: spin 1s linear infinite;
        }
    </style>
</head>
<body>
    <div class="grain"></div>
    <div class="spotlight" id="spotlight"></div>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // é è¨­ç¯„æœ¬
        const templates = [
            {
                id: 'website',
                name: 'ç¶²é ',
                icon: 'ğŸŒ',
                description: 'å»ºç«‹ç¾ä»£åŒ–çš„ç¶²é è¨­è¨ˆ',
                prompt: 'å‰µå»ºä¸€å€‹é—œæ–¼å’–å•¡çš„å–®é ç¶²ç«™ï¼ŒåŒ…å«é¦–é ã€é—œæ–¼æˆ‘å€‘ã€ç”¢å“å±•ç¤ºå’Œè¯çµ¡è³‡è¨Š'
            },
            {
                id: 'presentation',
                name: 'ç°¡å ±',
                icon: 'ğŸ“Š',
                description: 'è¨­è¨ˆå°ˆæ¥­çš„æ¼”ç¤ºæ–‡ç¨¿',
                prompt: 'è£½ä½œä¸€ä»½é—œæ–¼äººå·¥æ™ºæ…§è¶¨å‹¢çš„ç°¡å ±ï¼ŒåŒ…å«5å¼µæŠ•å½±ç‰‡'
            },
            {
                id: 'app',
                name: 'æ‡‰ç”¨ç¨‹å¼',
                icon: 'ğŸ“±',
                description: 'é–‹ç™¼äº’å‹•å¼æ‡‰ç”¨',
                prompt: 'å»ºç«‹ä¸€å€‹å¾…è¾¦äº‹é …ç®¡ç†æ‡‰ç”¨ï¼Œå¯ä»¥æ–°å¢ã€åˆªé™¤å’Œæ¨™è¨˜å®Œæˆä»»å‹™'
            },
            {
                id: 'dashboard',
                name: 'å„€è¡¨æ¿',
                icon: 'ğŸ“ˆ',
                description: 'æ‰“é€ æ•¸æ“šè¦–è¦ºåŒ–ä»‹é¢',
                prompt: 'è¨­è¨ˆä¸€å€‹éŠ·å”®æ•¸æ“šå„€è¡¨æ¿ï¼Œé¡¯ç¤ºåœ–è¡¨å’Œé—œéµæŒ‡æ¨™'
            },
            {
                id: 'landing',
                name: 'è½åœ°é ',
                icon: 'ğŸ¯',
                description: 'è£½ä½œç”¢å“å®£å‚³é é¢',
                prompt: 'å‰µå»ºä¸€å€‹ SaaS ç”¢å“çš„è½åœ°é ï¼Œå¼·èª¿åŠŸèƒ½å’Œè¨‚é–±æ–¹æ¡ˆ'
            },
            {
                id: 'custom',
                name: 'è‡ªè¨‚',
                icon: 'âœ¨',
                description: 'å¾é›¶é–‹å§‹å‰µä½œ',
                prompt: ''
            }
        ];

        function App() {
            const [prompt, setPrompt] = useState('');
            const [generatedCode, setGeneratedCode] = useState('');
            const [isGenerating, setIsGenerating] = useState(false);
            const [showPreview, setShowPreview] = useState(false);
            const [selectedTemplate, setSelectedTemplate] = useState(null);
            const [history, setHistory] = useState([]);
            const [showHistory, setShowHistory] = useState(false);
            const iframeRef = useRef(null);

            useEffect(() => {
                const handleMouseMove = (e) => {
                    const spotlight = document.getElementById('spotlight');
                    if (spotlight) {
                        const x = (e.clientX / window.innerWidth) * 100;
                        const y = (e.clientY / window.innerHeight) * 100;
                        spotlight.style.setProperty('--x', `${x}%`);
                        spotlight.style.setProperty('--y', `${y}%`);
                    }
                };

                window.addEventListener('mousemove', handleMouseMove);
                return () => window.removeEventListener('mousemove', handleMouseMove);
            }, []);

            useEffect(() => {
                const saved = localStorage.getItem('vibe_history');
                if (saved) {
                    setHistory(JSON.parse(saved));
                }
            }, []);

            const saveToHistory = (prompt, code) => {
                const newHistory = [{
                    id: Date.now(),
                    prompt,
                    code,
                    timestamp: new Date().toISOString()
                }, ...history].slice(0, 10);
                setHistory(newHistory);
                localStorage.setItem('vibe_history', JSON.stringify(newHistory));
            };

            const handleGenerate = async () => {
                if (!prompt.trim()) return;

                setIsGenerating(true);
                setShowPreview(false);

                try {
                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 4000,
                            messages: [{
                                role: 'user',
                                content: `ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„å‰ç«¯é–‹ç™¼è€…ã€‚æ ¹æ“šä»¥ä¸‹éœ€æ±‚ï¼Œç”Ÿæˆå®Œæ•´çš„ HTML ä»£ç¢¼ï¼ˆåŒ…å« CSS å’Œ JavaScriptï¼‰ã€‚
                                
è¦æ±‚ï¼š
1. ç”Ÿæˆå–®ä¸€å®Œæ•´çš„ HTML æ–‡ä»¶
2. CSS ä½¿ç”¨ <style> æ¨™ç±¤å…§åµŒ
3. JavaScript ä½¿ç”¨ <script> æ¨™ç±¤å…§åµŒ
4. ä»£ç¢¼è¦æœ‰è¨­è¨ˆæ„Ÿã€ç¾ä»£åŒ–ã€å¯ç›´æ¥é‹è¡Œ
5. åªè¼¸å‡º HTML ä»£ç¢¼ï¼Œä¸è¦æœ‰ä»»ä½•å…¶ä»–æ–‡å­—èªªæ˜
6. ä¸è¦ä½¿ç”¨ markdown æ ¼å¼çš„ä»£ç¢¼å€å¡Šæ¨™è¨˜

éœ€æ±‚ï¼š${prompt}

è«‹ç›´æ¥è¼¸å‡ºå®Œæ•´çš„ HTML ä»£ç¢¼ï¼š`
                            }]
                        })
                    });

                    const data = await response.json();
                    let code = data.content[0].text;
                    
                    // æ¸…ç†ä»£ç¢¼æ ¼å¼
                    code = code.replace(/```html\n?/g, '').replace(/```\n?/g, '').trim();
                    
                    setGeneratedCode(code);
                    saveToHistory(prompt, code);
                    setShowPreview(true);

                    // æ›´æ–° iframe
                    setTimeout(() => {
                        if (iframeRef.current) {
                            const iframe = iframeRef.current;
                            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                            iframeDoc.open();
                            iframeDoc.write(code);
                            iframeDoc.close();
                        }
                    }, 100);
                } catch (error) {
                    console.error('ç”Ÿæˆå¤±æ•—:', error);
                    alert('ç”Ÿæˆéç¨‹ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦');
                } finally {
                    setIsGenerating(false);
                }
            };

            const handleTemplateSelect = (template) => {
                setSelectedTemplate(template);
                setPrompt(template.prompt);
            };

            const handleDownload = () => {
                const blob = new Blob([generatedCode], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'vibe-creation.html';
                a.click();
                URL.revokeObjectURL(url);
            };

            const handleCopy = () => {
                navigator.clipboard.writeText(generatedCode);
                alert('ä»£ç¢¼å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ï¼');
            };

            const loadFromHistory = (item) => {
                setPrompt(item.prompt);
                setGeneratedCode(item.code);
                setShowPreview(true);
                setShowHistory(false);
                
                setTimeout(() => {
                    if (iframeRef.current) {
                        const iframe = iframeRef.current;
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        iframeDoc.open();
                        iframeDoc.write(item.code);
                        iframeDoc.close();
                    }
                }, 100);
            };

            return (
                <div className="min-h-screen relative z-10">
                    {/* Header */}
                    <header className="border-b border-gray-800 backdrop-blur-sm bg-black/30">
                        <div className="max-w-7xl mx-auto px-6 py-6 flex items-center justify-between">
                            <div className="flex items-center space-x-4">
                                <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-red-500 to-pink-500 flex items-center justify-center text-2xl glow">
                                    âœ¨
                                </div>
                                <div>
                                    <h1 className="text-3xl font-display font-bold tracking-tight">
                                        Vibe Studio
                                    </h1>
                                    <p className="text-sm text-gray-400 mt-1">å‰µé€ ä½ çš„æ•¸ä½ä½œå“</p>
                                </div>
                            </div>
                            <button
                                onClick={() => setShowHistory(!showHistory)}
                                className="btn-secondary px-6 py-3 rounded-xl font-medium"
                            >
                                ğŸ“š æ­·å²è¨˜éŒ„
                            </button>
                        </div>
                    </header>

                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-6 py-12">
                        {/* Templates Section */}
                        {!generatedCode && (
                            <div className="animate-fade-in-up mb-12">
                                <h2 className="text-2xl font-display font-semibold mb-6">
                                    é¸æ“‡ä¸€å€‹ç¯„æœ¬é–‹å§‹
                                </h2>
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4">
                                    {templates.map((template, index) => (
                                        <div
                                            key={template.id}
                                            onClick={() => handleTemplateSelect(template)}
                                            className={`template-card p-6 rounded-xl bg-gradient-to-br from-gray-800 to-gray-900 border ${
                                                selectedTemplate?.id === template.id
                                                    ? 'border-red-500'
                                                    : 'border-gray-700'
                                            }`}
                                            style={{ animationDelay: `${index * 0.1}s` }}
                                        >
                                            <div className="text-4xl mb-3">{template.icon}</div>
                                            <h3 className="font-semibold mb-2">{template.name}</h3>
                                            <p className="text-xs text-gray-400">{template.description}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Input Section */}
                        <div className="animate-fade-in-up" style={{ animationDelay: '0.2s' }}>
                            <div className="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 border border-gray-700 mb-8">
                                <label className="block text-lg font-semibold mb-4">
                                    æè¿°ä½ æƒ³å‰µå»ºçš„å…§å®¹
                                </label>
                                <textarea
                                    value={prompt}
                                    onChange={(e) => setPrompt(e.target.value)}
                                    placeholder="ä¾‹å¦‚ï¼šå‰µå»ºä¸€å€‹ç¾ä»£åŒ–çš„å€‹äººä½œå“é›†ç¶²ç«™ï¼ŒåŒ…å«é¦–é ã€é—œæ–¼æˆ‘ã€ä½œå“å±•ç¤ºå’Œè¯çµ¡è¡¨å–®..."
                                    className="w-full h-32 px-4 py-3 bg-gray-900 border border-gray-700 rounded-xl text-gray-100 placeholder-gray-500 custom-scrollbar"
                                    disabled={isGenerating}
                                />
                                <div className="flex items-center justify-between mt-6">
                                    <p className="text-sm text-gray-400">
                                        ğŸ’¡ æç¤ºï¼šæè¿°è¶Šè©³ç´°ï¼Œç”Ÿæˆçš„çµæœè¶Šç¬¦åˆé æœŸ
                                    </p>
                                    <button
                                        onClick={handleGenerate}
                                        disabled={isGenerating || !prompt.trim()}
                                        className="btn-primary px-8 py-3 rounded-xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"
                                    >
                                        {isGenerating ? (
                                            <>
                                                <div className="w-5 h-5 border-2 border-white border-t-transparent rounded-full spinner"></div>
                                                <span>ç”Ÿæˆä¸­...</span>
                                            </>
                                        ) : (
                                            <>
                                                <span>âœ¨</span>
                                                <span>é–‹å§‹å‰µä½œ</span>
                                            </>
                                        )}
                                    </button>
                                </div>
                            </div>
                        </div>

                        {/* Preview Section */}
                        {showPreview && generatedCode && (
                            <div className="animate-fade-in-up grid lg:grid-cols-2 gap-8" style={{ animationDelay: '0.3s' }}>
                                {/* Preview */}
                                <div>
                                    <div className="flex items-center justify-between mb-4">
                                        <h3 className="text-xl font-semibold">é è¦½</h3>
                                        <div className="flex space-x-2">
                                            <button
                                                onClick={handleCopy}
                                                className="btn-secondary px-4 py-2 rounded-lg text-sm"
                                            >
                                                ğŸ“‹ è¤‡è£½ä»£ç¢¼
                                            </button>
                                            <button
                                                onClick={handleDownload}
                                                className="btn-primary px-4 py-2 rounded-lg text-sm"
                                            >
                                                ğŸ’¾ ä¸‹è¼‰
                                            </button>
                                        </div>
                                    </div>
                                    <div className="preview-frame" style={{ height: '600px' }}>
                                        <iframe
                                            ref={iframeRef}
                                            className="w-full h-full"
                                            title="preview"
                                        />
                                    </div>
                                </div>

                                {/* Code */}
                                <div>
                                    <h3 className="text-xl font-semibold mb-4">åŸå§‹ç¢¼</h3>
                                    <div className="code-block custom-scrollbar" style={{ height: '600px' }}>
                                        {generatedCode}
                                    </div>
                                </div>
                            </div>
                        )}
                    </main>

                    {/* History Modal */}
                    {showHistory && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center modal-backdrop" onClick={() => setShowHistory(false)}>
                            <div className="bg-gray-900 rounded-2xl p-8 max-w-2xl w-full mx-4 border border-gray-700 max-h-[80vh] overflow-y-auto custom-scrollbar" onClick={(e) => e.stopPropagation()}>
                                <div className="flex items-center justify-between mb-6">
                                    <h2 className="text-2xl font-display font-semibold">æ­·å²è¨˜éŒ„</h2>
                                    <button
                                        onClick={() => setShowHistory(false)}
                                        className="text-gray-400 hover:text-white"
                                    >
                                        âœ•
                                    </button>
                                </div>
                                {history.length === 0 ? (
                                    <p className="text-gray-400 text-center py-8">å°šç„¡æ­·å²è¨˜éŒ„</p>
                                ) : (
                                    <div className="space-y-4">
                                        {history.map((item) => (
                                            <div
                                                key={item.id}
                                                onClick={() => loadFromHistory(item)}
                                                className="p-4 bg-gray-800 rounded-xl border border-gray-700 cursor-pointer hover:border-red-500 transition-colors"
                                            >
                                                <p className="text-sm text-gray-300 mb-2">{item.prompt}</p>
                                                <p className="text-xs text-gray-500">
                                                    {new Date(item.timestamp).toLocaleString('zh-TW')}
                                                </p>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Footer */}
                    <footer className="border-t border-gray-800 mt-20">
                        <div className="max-w-7xl mx-auto px-6 py-8 text-center text-gray-400 text-sm">
                            <p>Powered by Claude AI Â· ç”¨å‰µæ„é»äº®æ•¸ä½ä¸–ç•Œ</p>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>